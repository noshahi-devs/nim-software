<div class="dashboard-main-body">
  <app-breadcrumb [title]="'Staff Job Letter'"></app-breadcrumb>
<div class="card mb-24">
  <div class="card-body p-16">
    <div class="row align-items-end g-3 py-28">
      <!-- Search Field -->
      <div class="col-md-8">
        <label for="searchStaff" class="form-label fw-semibold text-primary-light text-sm mb-8">
          Enter Staff Details
        </label>
        <div class="position-relative">
          <input
            id="searchStaff"
            type="text"
            class="form-control radius-8 h-40-px text-md"
            placeholder="Type name, email, CNIC, or phone"
            [(ngModel)]="searchTerm"
            (input)="searchStaff()"
          />
          <iconify-icon 
            icon="ion:search-outline"
            class="position-absolute top-50 translate-middle-y end-0 me-16 text-secondary-light text-xl cursor-pointer"
            (click)="searchStaff()">
          </iconify-icon>
        </div>
      </div>

      <!-- Reload Button -->
      <div class="col-md-2 d-flex align-items-end">
        <button
          type="button"
          class="btn btn-light border w-100 radius-8 d-flex align-items-center justify-content-center gap-2 h-40-px"
          (click)="loadStaffList()">
          <iconify-icon icon="mdi:sync" class="text-lg text-primary"></iconify-icon>
          Reload
        </button>
      </div>
    </div>

    <!-- Results List -->
    <div *ngIf="filteredStaffList.length > 0 && searchTerm" class="mt-16 border radius-12 bg-base shadow-sm"
      style="max-height: 400px; overflow-y: auto;">
      <div *ngFor="let staff of filteredStaffList" (click)="selectStaff(staff)"
        class="p-16 border-bottom cursor-pointer"
        style="cursor: pointer; transition: background 0.2s;"
        onmouseover="this.style.backgroundColor='#f8f9fa'"
        onmouseout="this.style.backgroundColor='white'">
        <div class="d-flex align-items-center gap-16">
          <img [src]="staff.profile" class="w-56-px h-56-px rounded-circle object-fit-cover border" />
          <div class="flex-grow-1">
            <h6 class="mb-4 text-md fw-bold">{{ staff.name }}</h6>
            <p class="mb-2 text-sm text-secondary-light"><strong>Role:</strong> {{ staff.role || staff.designation }}</p>
            <p class="mb-0 text-sm text-secondary-light"><strong>CNIC:</strong> {{ staff.cnic }}</p>
          </div>
          <iconify-icon icon="solar:arrow-right-linear" class="text-xl text-primary-600"></iconify-icon>
        </div>
      </div>
    </div>

    <!-- No Results -->
    <div *ngIf="filteredStaffList.length === 0 && searchTerm"
      class="mt-16 p-24 text-center border radius-12 bg-neutral-50">
      <iconify-icon icon="mdi:account-search-outline" class="text-xxl text-secondary-light mb-8"></iconify-icon>
      <p class="mb-0 text-md text-secondary-light">
        No staff found matching "<strong>{{ searchTerm }}</strong>"
      </p>
    </div>
  </div>
</div>






  <div class="card" *ngIf="showLetter">
    <div class="card-header d-flex flex-wrap justify-content-between align-items-center">
      <h5 class="mb-0 fw-semibold">Appointment Letter - {{ teacher.name }}</h5>
      <div class="d-flex flex-wrap align-items-center gap-2">
        <button type="button" class="btn btn-sm btn-info radius-8 d-inline-flex align-items-center gap-1" (click)="sendSms()">
          <i class="pi pi-comment"></i> Send SMS
        </button>

        <button type="button" class="btn btn-sm btn-primary radius-8 d-inline-flex align-items-center gap-1" (click)="downloadPdf()">
          <i class="pi pi-download"></i> Download
        </button>

        <button type="button" class="btn btn-sm btn-warning radius-8 d-inline-flex align-items-center gap-1" (click)="editLetter()">
          <i class="pi pi-pencil"></i> Edit
        </button>

        <button type="button" class="btn btn-sm btn-success radius-8 d-inline-flex align-items-center gap-1" (click)="printLetter()">
          <i class="pi pi-print"></i> Print
        </button>
      </div>
    </div>

    <div class="card-body py-40">
      <div class="row justify-content-center" id="appointmentLetter">
        <div class="col-lg-8">
          <div class="shadow-4 border radius-8">
            <div class="p-20 d-flex flex-wrap justify-content-between align-items-center border-bottom">
              <div>
                <h3 class="text-xl fw-semibold mb-1">Noshahi Institute Manager</h3>
                <p class="mb-1 text-sm">4517 Washington Ave, Lahore, Pakistan</p>
                <p class="mb-0 text-sm">infonoshahi.edu.pk | +92 300 1234567</p>
              </div>
              <div>
                <img src="assets/images/logo.png" alt="Logo" class="mb-8" style="max-height: 60px" />
              </div>
            </div>

            <div class="py-28 px-20">
              <div class="text-center mb-4">
                <h4 class="text-uppercase fw-semibold mb-2">Appointment Letter</h4>
                <p class="text-sm text-secondary-light mb-0">Ref No: NIM/HR/2025/019</p>
              </div>

              <p class="text-sm mb-3">Date: <strong>{{ todayDate }}</strong></p>
              <p class="text-sm mb-4">To,</p>
              <p class="text-sm mb-1"><strong>{{ teacher.name }}</strong></p>
              <p class="text-sm mb-1">{{ teacher.address }}</p>
              <p class="text-sm mb-4">{{ teacher.city }}, Pakistan</p>

              <p class="text-sm mb-3">Subject: <strong>Appointment as {{ teacher.designation }}</strong></p>

              <p class="text-sm mb-4">
                Dear {{ teacher.name }},
              </p>

              <p class="text-sm mb-4" style="text-align: justify;">
                We are pleased to inform you that you have been appointed as a
                <strong>{{ teacher.designation }}</strong> at
                <strong>Noshahi Institute</strong>, effective from
                <strong>{{ teacher.joiningDate | date: 'longDate' }}</strong>.
                You will be responsible for teaching {{ teacher.subject }}
                and contributing to curriculum planning, student mentorship,
                and academic excellence.
              </p>

              <p class="text-sm mb-4" style="text-align: justify;">
                Your monthly salary will be <strong>PKR {{ teacher.salary | number }}</strong>,
                with additional benefits as per institute policy. Please report to the
                Principal’s Office on your joining date for orientation and document verification.
              </p>

              <p class="text-sm mb-4" style="text-align: justify;">
                We welcome you to the Noshahi Institute family and look forward to your
                valuable contributions toward our students’ success.
              </p>

              <p class="text-sm mb-4">Best regards,</p>

              <div class="d-flex flex-wrap justify-content-between align-items-end mt-64">
                <div class="text-sm border-top d-inline-block px-12">
                  Signature of Employee
                </div>
                <div class="text-sm border-top d-inline-block px-12">
                  Authorized Signatory<br />
                  (Principal / HR Department)
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
